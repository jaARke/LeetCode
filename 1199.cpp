#include <bits/stdc++.h>

using namespace std;

class Solution {
private:
    bool check(int m, vector<int>& blocks, int split) {
        int workers = 1;
        for (int i = 0; i < blocks.size(); i++) {
            if (blocks[i] > m || workers <= 0) return false;

            while (blocks[i] + split <= m) {
                workers <<= 1;
                m -= split;
            }

            if (workers >= blocks.size() - i) return true;
            workers--;
        }
        return true;
    }
public:
    int minBuildTime(vector<int>& blocks, int split) {
        sort(begin(blocks), end(blocks), greater<int>());

        int low = blocks[0], high = split * ceil(log2(blocks.size())) + blocks[0];

        while (low < high) {
            int m = (low + high) / 2;
            if (check(m, blocks, split)) high = m;
            else low = m + 1;
        }
        return high;
    }
};

int main() {
    Solution s;
    vector<int> blocks = {59185,46676,17003,5074,9225,5878,2864,76312,64817,64657,35564,94262,86499,38256,95759,86594,29641,80337,17884,65119,31001,33242,18862,65296,38529,71785,3803,50214,37810,88649,97183,28555,76982,97236,85990,28314,47621,3997,55915,88191,28968,74019,26671,52560,20062,25715,64525,91659,80260,12859,10617,54667,42223,27983,7054,34952,91713,32356,43639,89620,25609,17943,40182,31178,83321,27561,58531,58661,66346,89990,52627,97537,9924,23808,20463,18108,6196,70253,64093,16411,5422,93008,14987,36116,11247,23574,2699,83487,67509,74832,21621,38387,23697,90056,17898,21299,92567,12541,85376,28609,74525,26157,71463,98420,72852,68899,18201,28743,53976,524,56271,78125,64158,2455,24172,6266,48793,55579,50900,77661,41548,46079,594,37914,69414,4205,33116,71892,21719,39502,1979,80147,90339,71734,57431,77615,73045,55794,7204,94254,82761,80579,75978,32341,2824,58007,5256,55252,94660,82766,97897,97474,58178,94946,93876,41977,21500,13767,51827,13957,7674,15855,92253,84208,10852,72065,92933,78456,31110,53073,99749,60650,70506,85227,57855,1719,79213,10634,91610,22301,76335,37362,94947,18917,49368,71389,67917,44199,86730,91701,47922,69252,62250,49547,30701,69089,59893,71085,57736,64905,15503,37584,46592,21289,20332,18049,85504,78028,97645,29920,36174,29080,18517,85169,80832,3404,79208,36929,99174,63313,54368,66350,21487,27608,7939,4682,63606,32497,39628,2193,30103,22197,83142,65603,19180,6602,24950,60793,2638,78255,91377,58159,54746,37683,70966,75510,94390,40963,77935,57594,84628,96976,95832,98196,45803,59728,10355,53980,14024,29121,86955,87627,95243,77814,61520,64077,60891,51483,50969,95015,77292,81971,71179,89083,53616,59943,84519,84030,48039,68773,27777,25634,43906,64784,62470,64723,18981,73858,53039,50813,72487,24604,87175,17590,55503,7293,66793,7037,75027,62651,85206,52767,98455,97179,66394,31207,36465,29304,80037,13990,19506,80768,33766,41097,69439,18941,4883,73630,13485,86681,98095,69369,4170,27409,64777,9800,15368,97754,45900,59392,33853,46722,49329,30362,81522,59809,99897,3894,2245,75190,93981,92775,52275,82049,38363,34690,8962,19254,31791,93846,246,8469,56028,90577,94152,42465,7186,24054,86264,15207,58306,77774,40761,59321,99783,65405,53650,71437,4735,24641,61395,7369,39415,8107,56824,33807,22439,47051,487,7843,15628,22305,75528,5321,91431,79006,18646,3258,13253,73189,81774,30403,27679,37029,99189,93928,75173,18433,57292,1719,20425,7590,21067,64320,50879,2772,71222,51391,22357,84349,43765,82430,51719,64652,47808,34224,48727,24591,13886,73884,85189,17771,96554,60822,93935,96179,36125,16226,71834,73151,63399,22220,75404,4946,67533,20380,87520,35088,99754,80329,67646,36155,90438,67354,76759,26322,50156,27556,60943,3064,43374,13557,67177,52538,51593,27198,87279,78100,75459,13558,37093,50793,83602,45107,85926,63874,37927,81873,99146,91757,11675,84321,68051,70907,48091,10167,74409,58403,93605,13790,6554,12203,15018,22819,8171,76156,33271,59930,98169,19396,82532,56841,27992,50547,98505,29375,68850,60933,88816,60427,87210,499,93072,92886,92878,15003,11276,31864,4902,44,48628,11968,98980,46184,69562,39247,74184,52906,1325,57531,70550,8803,12207,13509,59131,1795,80301,80109,43050,7424,40371,65651,42917,22848,47187,90882,34095,16538,30896,53411,9863,34624,83261,10508,69340,90308,33303,12024,31526,6138,67243,57045,36066,81009,31956,11825,12737,66975,97800,65171,74892,68983,49364,65580,71485,55894,5163,38133,19222,66267,78554,95103,3870,99093,96056,16462,22402,58970,16715,62510,32917,26556,20237,49472,20017,19926,12022,9831,91907,2573,49756,80180,27375,53023,34562,10631,9170,46927,85150,27005,62178,72547,54976,78647,15346,94736,69285,99567,35293,82191,30408,99813,95459,53032,43617,63236,25646,42169,38672,20833,30496,12296,38336,53936,32178,78078,93890,71935,62441,75265,22778,24595,11551,97244,43058,90300,67709,37874,25867,67548,84266,2615,88287,17952,15694,409,35278,69855,7010,66285,66675,48869,49522,4756,36411,46893,25387,69616,46573,77289,2913,88764,27384,94963,64223,33033,80621,26367,32961,30140,16863,15333,55739,11937,76461,51702,31840,29880,25547,36648,22199,13189,40245,80054,40,43634,167,6742,93280,1345,32275,71163,63830,40135,42839,21842,63932,23975,32393,9584,35281,81516,83344,57368,35343,83581,81301,1512,45990,31919,17968,59537,68578,92821,26710,34448,89431,41125,42539,38347,82302,92522,405,87129,66439,31056,85169,2568,71757,84391,21373,55172,74656,91695,47826,38637,72425,37403,44953,67691,6529,98996,1666,96030,59534,81890,21716,48741,7815,62855,55678,45333,536,60620,22427,3575,16369,32004,89324,45989,5387,75025,52773,38162,16371,50228,64511,82232,73668,37690,980,83526,33030,76282,55830,25011,16844,55768,19908,75560,59198,93546,30647,14067,44152,18861,85510,80698,28154,70993,19141,4999,71647,81416,13692,10507,45067,83754,73676,13253,2696,92042,98688,3579,70357,36888,12167,34730,65756,62408,10344,37174,9898,24053,78315,70148,18785,63809,84039,12990,39119,16426,64877,25035,62203,91633,7591,95080,15026,44673,86347,1533,6478,86496,22638,80805,79657,17637,27735,12920,21670,8056,36268,36647,36490,95100,7503,54561,66614,39362,72544,25661,85842,4302,36967,98554,81302,59162,50293,92974,8750,47175,43938,56861,84494,46312,10791,35086,35453,35485,54494,71970,6415,1179,9484,3220,89846,60453,10247,63103,14401,11098,36687,89728,63795,58119,44131,91932,87670,92472,19327,63932,88622,2378,18580,27432,32729,36580,14656,48870,31954,7073,77600,15717,16851,4342,29389,97572,10303,41014,59134,2758,26440,17254,53180,40665,78348,40993,79694,99639,58274,95383,11235,21420,63966,68822,5425,42462,78878,11260,73897,98246,36413,71038,68349,33251,91135,37997,97282,20791,99250,83902,84368,99398,43158,14447,83636,47774,68741,78815,68981,41608,791,4095,24868,87462,43619,60634,94408,56679,91271,57415,94410,19262,20659,27737,24690,88443,90896,82798,54178,59466,10790,54418,78973,22924,95444,28970,76592,5290,10833,64282,3557,27689,9513,82821,55920,65784,16606,1761,68818,30819,48428,518,92340,28277,58312,62223,77801,8797};
    int split = 43;
    cout << s.minBuildTime(blocks, split) << endl;
    return 0;
}